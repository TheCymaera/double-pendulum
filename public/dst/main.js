!function(){"use strict";class t{_handle;dispose(){clearInterval(this._handle)}static delayed(t){return new Promise((e=>setTimeout(e,t.milliseconds)))}static periodic(e,i){return new t(setInterval((()=>{i.call(this)}),e.milliseconds))}constructor(t){this._handle=t}}class e{constructor(t){this.dispose=t}dispose(){}static is(t){return t&&"dispose"in t}static all(...t){return new e((()=>{for(const i of t)e.is(i)&&i.dispose()}))}static empty=new e((()=>{}))}class i{milliseconds;constructor({milliseconds:t=0,seconds:e=0,minutes:s=0,hours:n=0,days:o=0,weeks:r=0}){this.milliseconds=t+e*i.millisecondsPerSecond+s*i.millisecondsPerMinute+n*i.millisecondsPerHour+o*i.millisecondsPerDay+r*i.millisecondsPerWeek}set seconds(t){this.milliseconds=t*i.millisecondsPerSecond}get seconds(){return this.milliseconds/i.millisecondsPerSecond}set minutes(t){this.milliseconds=t*i.millisecondsPerMinute}get minutes(){return this.milliseconds/i.millisecondsPerMinute}set hours(t){this.milliseconds=t*i.millisecondsPerHour}get hours(){return this.milliseconds/i.millisecondsPerHour}set days(t){this.milliseconds=t*i.millisecondsPerDay}get days(){return this.milliseconds/i.millisecondsPerDay}set weeks(t){this.milliseconds=t*i.millisecondsPerWeek}get weeks(){return this.milliseconds/i.millisecondsPerWeek}get weeksPart(){return Math.floor(this.milliseconds/i.millisecondsPerWeek)}get daysPart(){return Math.floor(this.milliseconds/i.millisecondsPerDay)}get hoursPart(){return Math.floor(this.milliseconds%i.millisecondsPerDay/i.millisecondsPerHour)}get minutesPart(){return Math.floor(this.milliseconds%i.millisecondsPerHour/i.millisecondsPerMinute)}get secondsPart(){return Math.floor(this.milliseconds%i.millisecondsPerMinute/i.millisecondsPerSecond)}get millisecondsPart(){return this.milliseconds%i.millisecondsPerSecond}clone(){return new i({milliseconds:this.milliseconds})}abs(){return this.milliseconds=Math.abs(this.milliseconds),this}toString(){const t=this.clone().abs();return`${this.daysPart}:${t.hoursPart}:${t.minutesPart}:${t.secondsPart}:${t.millisecondsPart}`}static millisecondsPerSecond=1e3;static millisecondsPerMinute=60*i.millisecondsPerSecond;static millisecondsPerHour=60*i.millisecondsPerMinute;static millisecondsPerDay=24*i.millisecondsPerHour;static millisecondsPerWeek=7*i.millisecondsPerDay}class s{x;y;constructor(t,e){this.x=t,this.y=e}clone(){return new s(this.x,this.y)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}distanceTo(t){const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}angleTo(t){const e=t.x-this.x,i=t.y-this.y;return Math.atan2(i,e)}normalize(){const t=this.length();return t>0&&(this.x/=t,this.y/=t),this}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t,this.y*=t,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),s=this.x,n=this.y;return this.x=s*e-n*i,this.y=s*i+n*e,this}toString(){return`Vec2(${this.x.toFixed(3)}, ${this.y.toFixed(3)})`}static zero=Object.freeze(new s(0,0))}class n{center;radius;constructor(t,e){this.center=t,this.radius=e}static zero=Object.freeze(new n(s.zero,0))}class o{origin=new s(0,0);segments=[];setOrigin(t){return this.origin=t,this}lineTo(t){return this.segments.push(new o.LineTo(t)),this}close(){return this.segments.push(new o.Close),this}}!function(t){t.LineTo=class{point;constructor(t){this.point=t}};t.Close=class{constructor(){}}}(o||(o={}));class r{x1;y1;x2;y2;constructor(t,e,i,s){this.x1=t,this.y1=e,this.x2=i,this.y2=s}static zero=Object.freeze(new r(0,0,0,0));static fromPoints(t,e){return new r(t.x,t.y,e.x,e.y)}static fromCenter(t,e,i){const s=t.x-e/2,n=t.y-i/2;return new r(s,n,s+e,n+i)}static fromXYWH(t,e,i,s){return new r(t,e,t+i,e+s)}static fromLBRT(t,e,i,s){return new r(t,e,i,s)}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}set width(t){this.x2=this.x1+t}set height(t){this.y2=this.y1+t}get center(){return new s((this.x1+this.x2)/2,(this.y1+this.y2)/2)}set center(t){const e=this.width,i=this.height;this.x1=t.x-e/2,this.y1=t.y-i/2,this.x2=t.x+e/2,this.y2=t.y+i/2}get minX(){return Math.min(this.x1,this.x2)}get minY(){return Math.min(this.y1,this.y2)}get maxX(){return Math.max(this.x1,this.x2)}get maxY(){return Math.max(this.y1,this.y2)}toString(){return`Rect(${this.x1.toFixed(3)}, ${this.y1.toFixed(3)}, ${this.width.toFixed(3)}, ${this.height.toFixed(3)})`}static mapPointOnto(t,e,i){const n=(e.x-t.x1)/(t.x2-t.x1)*(i.x2-i.x1)+i.x1,o=(e.y-t.y1)/(t.y2-t.y1)*(i.y2-i.y1)+i.y1;return new s(n,o)}static mapRectOnto(t,e,i){return r.fromPoints(r.mapPointOnto(t,new s(e.x1,e.y1),i),r.mapPointOnto(t,new s(e.x2,e.y2),i))}}class c{r;g;b;a;static fromRGBA(t,e,i,s){return new c(t,e,i,s)}static black=Object.freeze(new c(0,0,0,255));static white=Object.freeze(new c(255,255,255,255));static transparent=Object.freeze(new c(0,0,0,0));constructor(t,e,i,s){this.r=0|t,this.g=0|e,this.b=0|i,this.a=0|s}toString(){return"#"+this.r.toString(16).padStart(2,"0")+this.g.toString(16).padStart(2,"0")+this.b.toString(16).padStart(2,"0")+this.a.toString(16).padStart(2,"0")}}class h{color;width;cap;join;miterLimit;constructor({color:t=c.transparent,width:e=1,cap:i=h.Cap.Butt,join:s=h.Join.Miter,miterLimit:n=10}={}){this.color=t,this.width=e,this.cap=i,this.join=s,this.miterLimit=n}}!function(t){var e,i;(e=t.Cap||(t.Cap={}))[e.Butt=0]="Butt",e[e.Round=1]="Round",e[e.Square=2]="Square",(i=t.Join||(t.Join={}))[i.Miter=0]="Miter",i[i.Round=1]="Round",i[i.Bevel=2]="Bevel"}(h||(h={}));class l{ctx;constructor(t){this.ctx=t}static fromCanvas(t){return new l(t.getContext("2d"))}viewRect(){return this.#t}clientRect(){return r.fromLBRT(0,this.ctx.canvas.clientHeight,this.ctx.canvas.clientWidth,0)}bitmapRect(){return r.fromLBRT(0,this.ctx.canvas.height,this.ctx.canvas.width,0)}setViewRect(t){this.#t=t}clear(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}drawLine(t,e,i){const s=r.mapPointOnto(this.#t,t,this.bitmapRect()),n=r.mapPointOnto(this.#t,e,this.bitmapRect());this.#e(i),this.ctx.beginPath(),this.ctx.moveTo(s.x,s.y),this.ctx.lineTo(n.x,n.y),this.ctx.stroke()}drawPath(t,e){this.#e(e),this.#i(t),this.ctx.stroke()}drawCircle(t,e){const i=r.mapPointOnto(this.#t,t.center,this.bitmapRect()),s=t.radius*this.ctx.canvas.width/this.#t.width;this.#s(e),this.ctx.beginPath(),this.ctx.arc(i.x,i.y,s,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke()}drawRect(t,e){const i=r.mapRectOnto(this.#t,t,this.bitmapRect());this.#s(e),this.ctx.beginPath(),this.ctx.rect(i.x1,i.y1,i.width,i.height),this.ctx.fill(),this.ctx.stroke()}drawSprite(t,e){const i=r.mapRectOnto(this.#t,t,this.bitmapRect()),s=e.bitmapRect;this.ctx.drawImage(e.image,s.x1,s.y1,s.width,s.height,i.x1,i.y1,i.width,i.height)}#t=r.zero;#i(t){this.ctx.beginPath();const e=r.mapPointOnto(this.#t,t.origin,this.bitmapRect());this.ctx.moveTo(e.x,e.y);for(const e of t.segments){if(e instanceof o.LineTo){const t=r.mapPointOnto(this.#t,e.point,this.bitmapRect());this.ctx.lineTo(t.x,t.y)}e instanceof o.Close&&this.ctx.closePath()}}#e(t){switch(this.ctx.lineWidth=t.width,this.ctx.strokeStyle=t.color.toString(),this.ctx.miterLimit=t.miterLimit,t.cap){case h.Cap.Butt:this.ctx.lineCap="butt";break;case h.Cap.Round:this.ctx.lineCap="round";break;case h.Cap.Square:this.ctx.lineCap="square"}switch(t.join){case h.Join.Miter:this.ctx.lineJoin="miter";break;case h.Join.Round:this.ctx.lineJoin="round";break;case h.Join.Bevel:this.ctx.lineJoin="bevel"}}#s(t){this.#e(t.stroke),this.ctx.fillStyle=t.fillColor.toString()}}const a=t=>Math.sin(t),d=t=>Math.cos(t),m=t=>t*t;class u{stroke;fillColor;constructor({stroke:t=new h,fillColor:e=c.transparent}={}){this.stroke=t,this.fillColor=e}}function y(t){const e=document.createElement("canvas");e.width=e.height=1;const i=e.getContext("2d");i.fillStyle=t,i.fillRect(0,0,1,1);const s=i.getImageData(0,0,1,1).data;return c.fromRGBA(s[0],s[1],s[2],s[3])}const x=y(getComputedStyle(document.body).color),g=y(getComputedStyle(document.body).getPropertyValue("--accent-color")),w=new h({color:x,width:3,cap:h.Cap.Round}),p=new u({fillColor:x}),P=new u({fillColor:g}),v=new u({stroke:new h({color:g,width:3})});document.querySelector("#openDialog").onclick=document.querySelector("#closeDialog").onclick=()=>{document.body.toggleAttribute("data-dialog-opened")},document.querySelector("#share").onclick=async()=>{try{await navigator.share({title:document.title,text:document.querySelector('meta[name="description"]')?.content??document.title,url:window.location.href})}catch{alert("Sharing is not supported in this environment.")}};const f=document.querySelector("canvas"),R=l.fromCanvas(f);let S;new ResizeObserver((()=>{const t=500,e=f.clientHeight/f.clientWidth,i=f.clientHeight<f.clientWidth?r.fromCenter(s.zero,t/e,t):r.fromCenter(s.zero,t,t*e);R.setViewRect(i),f.width=f.clientWidth,f.height=f.clientHeight,M()})).observe(f);const b=s.zero,C=new class{gravity=1;mass1=1;mass2=1;length1=90;length2=90;angle1=0;angle2=0;velocity1=0;velocity2=0;step(){const t=this.gravity,e=this.mass1,i=this.mass2,s=this.angle1+Math.PI/2,n=this.angle2+Math.PI/2,o=this.length1,r=this.length2,c=this.velocity1,h=this.velocity2,l=(-t*(2*e+i)*a(s)+-i*t*a(s-2*n)+-2*a(s-n)*i*(m(h)*r+c*c*o*d(s-n)))/(o*(2*e+i-i*d(2*s-2*n))),u=2*a(s-n)*(m(c)*o*(e+i)+t*(e+i)*d(s)+m(h)*r*i*d(s-n))/(r*(2*e+i-i*d(2*s-2*n)));this.velocity1+=l,this.velocity2+=u,this.angle1+=this.velocity1,this.angle2+=this.velocity2}line1(){return new s(this.length1,0).rotate(this.angle1)}line2(){return new s(this.length2,0).rotate(this.angle2)}point1(){return this.line1()}point2(){return this.line1().add(this.line2())}};function M(){const t=C.point1().add(b),e=C.point2().add(b),i=(t,e)=>{e?(R.drawCircle(new n(t,10),P),R.drawCircle(new n(t,13),v)):R.drawCircle(new n(t,10),p)};R.clear(),R.drawPath((new o).setOrigin(b).lineTo(t).lineTo(e),w),i(t,1===S),i(e,2===S)}C.angle1=-Math.PI/2,t.periodic(new i({seconds:1/30}),(()=>{const t=C.point1().add(b);S?(C.velocity1=0,C.velocity2=0,1===S&&(C.angle1=b.angleTo(k)),2===S&&(C.angle2=t.angleTo(k))):C.step(),M()}));let k=s.zero;f.onmousedown=()=>{const t=C.point1().add(b),e=C.point2().add(b);t.distanceTo(k)<30?S=1:e.distanceTo(k)<30&&(S=2)},f.onmouseup=()=>{S=void 0},f.onmousemove=t=>{const e=new s(t.clientX,t.clientY);k=r.mapPointOnto(R.clientRect(),e,R.viewRect())},console.log('For debugging, see "app"'),Object.defineProperty(window,"app",{value:{canvas:f,dp:C,origin:b}})}();
//# sourceMappingURL=main.js.map
