!function(){"use strict";class t{constructor(t){this.dispose=t}dispose(){}static is(t){return t&&"dispose"in t}static all(...e){return new t((()=>{for(const i of e)t.is(i)&&i.dispose()}))}static empty=new t((()=>{}))}class e{milliseconds;constructor({milliseconds:t=0,seconds:i=0,minutes:s=0,hours:n=0,days:o=0,weeks:r=0}){this.milliseconds=t+i*e.millisecondsPerSecond+s*e.millisecondsPerMinute+n*e.millisecondsPerHour+o*e.millisecondsPerDay+r*e.millisecondsPerWeek}set seconds(t){this.milliseconds=t*e.millisecondsPerSecond}get seconds(){return this.milliseconds/e.millisecondsPerSecond}set minutes(t){this.milliseconds=t*e.millisecondsPerMinute}get minutes(){return this.milliseconds/e.millisecondsPerMinute}set hours(t){this.milliseconds=t*e.millisecondsPerHour}get hours(){return this.milliseconds/e.millisecondsPerHour}set days(t){this.milliseconds=t*e.millisecondsPerDay}get days(){return this.milliseconds/e.millisecondsPerDay}set weeks(t){this.milliseconds=t*e.millisecondsPerWeek}get weeks(){return this.milliseconds/e.millisecondsPerWeek}get weeksPart(){return Math.floor(this.milliseconds/e.millisecondsPerWeek)}get daysPart(){return Math.floor(this.milliseconds/e.millisecondsPerDay)}get hoursPart(){return Math.floor(this.milliseconds%e.millisecondsPerDay/e.millisecondsPerHour)}get minutesPart(){return Math.floor(this.milliseconds%e.millisecondsPerHour/e.millisecondsPerMinute)}get secondsPart(){return Math.floor(this.milliseconds%e.millisecondsPerMinute/e.millisecondsPerSecond)}get millisecondsPart(){return this.milliseconds%e.millisecondsPerSecond}clone(){return new e({milliseconds:this.milliseconds})}abs(){return this.milliseconds=Math.abs(this.milliseconds),this}toString(){const t=this.clone().abs();return`${this.daysPart}:${t.hoursPart}:${t.minutesPart}:${t.secondsPart}:${t.millisecondsPart}`}static millisecondsPerSecond=1e3;static millisecondsPerMinute=60*e.millisecondsPerSecond;static millisecondsPerHour=60*e.millisecondsPerMinute;static millisecondsPerDay=24*e.millisecondsPerHour;static millisecondsPerWeek=7*e.millisecondsPerDay}class i{addListener(e){return this.#t.add(e),new t((()=>this.removeListener(e)))}removeListener(t){this.#t.delete(t)}addOnceListener(t){const e=i=>{this.removeListener(e),t(i)};return this.addListener(e)}[Symbol.asyncIterator](){return new i.Queue(this)}Emit(t){for(const e of this.#t)e(t)}#t=new Set}!function(t){class e{onQueueShifted=new s;constructor(t){this.#e=[],this.#i=t,t.addListener((t=>this.#e.push(t)))}[Symbol.asyncIterator](){return this}isEmpty(){return 0===this.#e.length}async next(){return 0===this.#e.length&&await new Promise((t=>this.#i.addOnceListener(t))),this.onQueueShifted.emit(),{done:!1,value:this.#e.shift()}}#i;#e}t.Queue=e}(i||(i={}));class s extends i{emit(t){super.Emit(t)}}class n{_handle;dispose(){clearInterval(this._handle)}static schedule(t){return new Promise((e=>setTimeout(e,t.milliseconds)))}static periodic(t,e){return new n(setInterval((()=>{e.call(this)}),t.milliseconds))}constructor(t){this._handle=t}}class o{x;y;constructor(t,e){this.x=t,this.y=e}clone(){return new o(this.x,this.y)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}distanceTo(t){const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}angleTo(t){const e=t.x-this.x,i=t.y-this.y;return Math.atan2(i,e)}normalize(){const t=this.length();return t>0&&(this.x/=t,this.y/=t),this}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t,this.y*=t,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),s=this.x,n=this.y;return this.x=s*e-n*i,this.y=s*i+n*e,this}toString(){return`Vec2(${this.x.toFixed(3)}, ${this.y.toFixed(3)})`}static zero=Object.freeze(new o(0,0))}class r{center;radius;constructor(t,e){this.center=t,this.radius=e}static zero=Object.freeze(new r(o.zero,0))}class c{origin=new o(0,0);segments=[];setOrigin(t){return this.origin=t,this}lineTo(t){return this.segments.push(new c.LineTo(t)),this}close(){return this.segments.push(new c.Close),this}}!function(t){t.LineTo=class{point;constructor(t){this.point=t}};t.Close=class{constructor(){}}}(c||(c={}));class h{x1;y1;x2;y2;constructor(t,e,i,s){this.x1=t,this.y1=e,this.x2=i,this.y2=s}static zero=Object.freeze(new h(0,0,0,0));static fromPoints(t,e){return new h(t.x,t.y,e.x,e.y)}static fromCenter(t,e,i){const s=t.x-e/2,n=t.y-i/2;return new h(s,n,s+e,n+i)}static fromDimensions(t,e,i,s){return new h(t,e,t+i,e+s)}static fromCoordinates(t,e,i,s){return new h(t,e,i,s)}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}set width(t){this.x2=this.x1+t}set height(t){this.y2=this.y1+t}get center(){return new o((this.x1+this.x2)/2,(this.y1+this.y2)/2)}set center(t){const e=this.width,i=this.height;this.x1=t.x-e/2,this.y1=t.y-i/2,this.x2=t.x+e/2,this.y2=t.y+i/2}get minX(){return Math.min(this.x1,this.x2)}get minY(){return Math.min(this.y1,this.y2)}get maxX(){return Math.max(this.x1,this.x2)}get maxY(){return Math.max(this.y1,this.y2)}toString(){return`Rect(${this.x1.toFixed(3)}, ${this.y1.toFixed(3)}, ${this.width.toFixed(3)}, ${this.height.toFixed(3)})`}static mapPointOnto(t,e,i){const s=(e.x-t.x1)/(t.x2-t.x1)*(i.x2-i.x1)+i.x1,n=(e.y-t.y1)/(t.y2-t.y1)*(i.y2-i.y1)+i.y1;return new o(s,n)}static mapRectOnto(t,e,i){return h.fromPoints(h.mapPointOnto(t,new o(e.x1,e.y1),i),h.mapPointOnto(t,new o(e.x2,e.y2),i))}}class l{r;g;b;a;static fromRGBA(t,e,i,s){return new l(t,e,i,s)}static black=Object.freeze(new l(0,0,0,255));static white=Object.freeze(new l(255,255,255,255));static transparent=Object.freeze(new l(0,0,0,0));constructor(t,e,i,s){this.r=0|t,this.g=0|e,this.b=0|i,this.a=0|s}toString(){return"#"+this.r.toString(16).padStart(2,"0")+this.g.toString(16).padStart(2,"0")+this.b.toString(16).padStart(2,"0")+this.a.toString(16).padStart(2,"0")}}class a{color;width;cap;join;miterLimit;constructor({color:t=l.transparent,width:e=1,cap:i=a.Cap.Butt,join:s=a.Join.Miter,miterLimit:n=10}={}){this.color=t,this.width=e,this.cap=i,this.join=s,this.miterLimit=n}}!function(t){var e,i;(e=t.Cap||(t.Cap={}))[e.Butt=0]="Butt",e[e.Round=1]="Round",e[e.Square=2]="Square",(i=t.Join||(t.Join={}))[i.Miter=0]="Miter",i[i.Round=1]="Round",i[i.Bevel=2]="Bevel"}(a||(a={}));class d{stroke;fillColor;constructor({stroke:t=new a,fillColor:e=l.transparent}={}){this.stroke=t,this.fillColor=e}}class u{ctx;constructor(t){this.ctx=t}static fromCanvas(t){return new u(t.getContext("2d"))}static sampleCSSColor(t){const e=document.createElement("canvas");e.width=e.height=1;const i=e.getContext("2d");i.fillStyle=t,i.fillRect(0,0,1,1);const s=i.getImageData(0,0,1,1).data;return l.fromRGBA(s[0],s[1],s[2],s[3])}viewportRect(){return this.#s}setViewportRect(t){this.#s=t}clientRect(){return h.fromCoordinates(0,this.ctx.canvas.clientHeight,this.ctx.canvas.clientWidth,0)}bitmapRect(){return h.fromCoordinates(0,this.ctx.canvas.height,this.ctx.canvas.width,0)}clear(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}drawLine(t,e,i){const s=h.mapPointOnto(this.#s,t,this.bitmapRect()),n=h.mapPointOnto(this.#s,e,this.bitmapRect());this.#n(i),this.ctx.beginPath(),this.ctx.moveTo(s.x,s.y),this.ctx.lineTo(n.x,n.y),this.ctx.stroke()}drawPath(t,e){this.#n(e),this.#o(t),this.ctx.stroke()}drawCircle(t,e){const i=h.mapPointOnto(this.#s,t.center,this.bitmapRect()),s=t.radius*this.ctx.canvas.width/this.#s.width;this.#r(e),this.ctx.beginPath(),this.ctx.arc(i.x,i.y,s,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke()}drawRect(t,e){const i=h.mapRectOnto(this.#s,t,this.bitmapRect());this.#r(e),this.ctx.beginPath(),this.ctx.rect(i.x1,i.y1,i.width,i.height),this.ctx.fill(),this.ctx.stroke()}drawSprite(t,e){const i=h.mapRectOnto(this.#s,t,this.bitmapRect()),s=e.bitmapRect;this.ctx.drawImage(e.image,s.x1,s.y1,s.width,s.height,i.x1,i.y1,i.width,i.height)}#s=h.zero;#o(t){this.ctx.beginPath();const e=h.mapPointOnto(this.#s,t.origin,this.bitmapRect());this.ctx.moveTo(e.x,e.y);for(const e of t.segments){if(e instanceof c.LineTo){const t=h.mapPointOnto(this.#s,e.point,this.bitmapRect());this.ctx.lineTo(t.x,t.y)}e instanceof c.Close&&this.ctx.closePath()}}#n(t){switch(this.ctx.lineWidth=t.width,this.ctx.strokeStyle=t.color.toString(),this.ctx.miterLimit=t.miterLimit,t.cap){case a.Cap.Butt:this.ctx.lineCap="butt";break;case a.Cap.Round:this.ctx.lineCap="round";break;case a.Cap.Square:this.ctx.lineCap="square"}switch(t.join){case a.Join.Miter:this.ctx.lineJoin="miter";break;case a.Join.Round:this.ctx.lineJoin="round";break;case a.Join.Bevel:this.ctx.lineJoin="bevel"}}#r(t){this.#n(t.stroke),this.ctx.fillStyle=t.fillColor.toString()}}const m=t=>Math.sin(t),y=t=>Math.cos(t),x=t=>t*t;const p=u.sampleCSSColor(getComputedStyle(document.body).color),g=u.sampleCSSColor(getComputedStyle(document.body).getPropertyValue("--accent-color")),w=new a({color:p,width:3,cap:a.Cap.Round}),P=new d({fillColor:p}),v=new d({fillColor:g}),S=new d({stroke:new a({color:g,width:3})});document.querySelector("#openDialog").onclick=document.querySelector("#closeDialog").onclick=()=>{document.body.toggleAttribute("data-dialog-opened")},document.querySelector("#share").onclick=async()=>{try{await navigator.share({title:document.title,text:document.querySelector('meta[name="description"]')?.content??document.title,url:window.location.href})}catch{alert("Sharing is not supported in this environment.")}};const f=document.querySelector("canvas"),b=u.fromCanvas(f);let R;new ResizeObserver((()=>{const t=500,e=f.clientHeight/f.clientWidth,i=f.clientHeight<f.clientWidth?h.fromCenter(o.zero,t/e,t):h.fromCenter(o.zero,t,t*e);b.setViewportRect(i),f.width=f.clientWidth,f.height=f.clientHeight,k()})).observe(f);const C=o.zero,M=new class{gravity=1;mass1=1;mass2=1;length1=90;length2=90;angle1=0;angle2=0;velocity1=0;velocity2=0;step(){const t=this.gravity,e=this.mass1,i=this.mass2,s=this.angle1+Math.PI/2,n=this.angle2+Math.PI/2,o=this.length1,r=this.length2,c=this.velocity1,h=this.velocity2,l=(-t*(2*e+i)*m(s)+-i*t*m(s-2*n)+-2*m(s-n)*i*(x(h)*r+c*c*o*y(s-n)))/(o*(2*e+i-i*y(2*s-2*n))),a=2*m(s-n)*(x(c)*o*(e+i)+t*(e+i)*y(s)+x(h)*r*i*y(s-n))/(r*(2*e+i-i*y(2*s-2*n)));this.velocity1+=l,this.velocity2+=a,this.angle1+=this.velocity1,this.angle2+=this.velocity2}line1(){return new o(this.length1,0).rotate(this.angle1)}line2(){return new o(this.length2,0).rotate(this.angle2)}point1(){return this.line1()}point2(){return this.line1().add(this.line2())}};function k(){const t=M.point1().add(C),e=M.point2().add(C),i=(t,e)=>{e?(b.drawCircle(new r(t,10),v),b.drawCircle(new r(t,13),S)):b.drawCircle(new r(t,10),P)};b.clear(),b.drawPath((new c).setOrigin(C).lineTo(t).lineTo(e),w),i(t,1===R),i(e,2===R)}M.angle1=-Math.PI/2,n.periodic(new e({seconds:1/30}),(()=>{const t=M.point1().add(C);R?(M.velocity1=0,M.velocity2=0,1===R&&(M.angle1=C.angleTo(O)),2===R&&(M.angle2=t.angleTo(O))):M.step(),k()}));let O=o.zero;const q=t=>{const e=new o(t.clientX,t.clientY);O=h.mapPointOnto(b.clientRect(),e,b.viewportRect())};f.onpointermove=q,f.onpointerdown=t=>{q(t);const e=M.point1().add(C),i=M.point2().add(C);e.distanceTo(O)<30?R=1:i.distanceTo(O)<30&&(R=2)},f.onpointerup=()=>{R=void 0},console.log('For debugging, see "app"'),Object.defineProperty(window,"app",{value:{canvas:f,dp:M,origin:C}})}();
//# sourceMappingURL=main.js.map
